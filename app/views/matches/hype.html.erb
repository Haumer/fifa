<h1>Vote for the match you are most hyped for!</h1>

<div class="container">

    <% sorted_matches = @matches.sort_by { |k| k.get_upvotes.count} %>
    <% sorted_matches.reverse.each do |match_unit| %>
    <div class="hype_content">
      <div class="vote_count">
        <div class="product-arrow"></div>
        <h1 class="product-count"><%= match_unit.get_upvotes.size %></h1>
      </div>
      <div class="hype_match">
        <% if match_unit.match_status == "Not played" %>
          <%= link_to match_path(match_unit) do %>
            <%= match_unit.home_name %> vs <%= match_unit.away_name%>
          <% end %>
          <br>
          <%= match_unit.location %>
          <br>
          <span id="countdown" class="countdown"><%= match_unit.date %></span>
          <br>
          <%= match_unit.date %>
        <% end %>
      <script>
        // Set the date we're counting down to
        var countdown_divs = document.querySelectorAll(".countdown")
        console.log(countdown_divs)
        countdown_divs.forEach((div) => {
          var countDownDate = new Date(div.innerHTML).getTime();

          // Update the count down every 1 second
          var x = setInterval(function() {

          // Get todays date and time
          var now = new Date().getTime();

          // Find the distance between now an the count down date
          var distance = countDownDate - now;

          // Time calculations for days, hours, minutes and seconds
          var days = Math.floor(distance / (1000 * 60 * 60 * 24));
          var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
          var seconds = Math.floor((distance % (1000 * 60)) / 1000);

          // Display the result in the element with id="demo"
          div.innerHTML = days + "d " + hours + "h "
          + minutes + "m " + seconds + "s ";

          // If the count down is finished, write some text
          if (distance < 0) {
            clearInterval(x);
            div.innerHTML = "LIVE";
              }
            }, 1000);
          });
      </script>
        <div class="vote_button">
          <%= link_to like_match_path(match_unit), class: "like", method: :put do%>
          <button type="button" class="btn btn-primary" aria-label="left-align">
            <span badge="">Vote</span>
          </button>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>




