<h1>Hype</h1>

<div class="container">
  <% sorted_matches = @matches.sort_by { |k| k["date"]} %>
  <% sorted_matches.each do |match_unit| %>
    <div class="match">
      <%= link_to match_path(match_unit) do %>
        <%= match_unit.home_name %> vs <%= match_unit.away_name%>
      <% end %>
      <br>
      <%= match_unit.location %>
      <br>
      <span id="countdown" class="countdown"><%= match_unit.date %></span>
      <br>
      <%= match_unit.date %>
      <%= link_to like_match_path(match_unit), class: "like", method: :put do%>
      <button type="button" class="btn btn-info" aria-label="left-align">
        <span badge=""><%= match_unit.get_upvotes.size %></span>
      </button>
      <% end %>
    <script>
      // Set the date we're counting down to
      var countdown_divs = document.querySelectorAll(".countdown")
      console.log(countdown_divs)
      countdown_divs.forEach((div) => {
        var countDownDate = new Date(div.innerHTML).getTime();

        // Update the count down every 1 second
        var x = setInterval(function() {

        // Get todays date and time
        var now = new Date().getTime();

        // Find the distance between now an the count down date
        var distance = countDownDate - now;

        // Time calculations for days, hours, minutes and seconds
        var days = Math.floor(distance / (1000 * 60 * 60 * 24));
        var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        var seconds = Math.floor((distance % (1000 * 60)) / 1000);

        // Display the result in the element with id="demo"
        div.innerHTML = days + "d " + hours + "h "
        + minutes + "m " + seconds + "s ";

        // If the count down is finished, write some text
        if (distance < 0) {
          clearInterval(x);
          div.innerHTML = "LIVE";
            }
          }, 1000);
        });
    </script>
    </div>
  <% end %>
</div>




